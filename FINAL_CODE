// Jake Levin & George Kremastas ( Final Project)

#include <LiquidCrystal.h>
  #include <DHT.h>
  #include <DHT_U.h>
  #include <Stepper.h>
  
  #define DHTPIN 7
  #define DHTTYPE DHT11
  #define tempMax 78

  const int buttonPin = 2;
  const int motorPin = 18;
  const int fanPin = 20;
  const int rPin = 14;
  const int gPin = 15;
  const int bPin = 16;


  bool buttonPressed;

  int lastButtonState;
  int currentButtonState;

  LiquidCrystal lcd(3,4,5,6,12,13);
  DHT dht(DHTPIN, DHTTYPE);

  const int stepsperRevolution = 32;
  Stepper myStepper(stepsperRevolution, 8, 9, 10, 11);

#define RDA 0x80
#define TBE 0x20   


volatile unsigned char *myUCSR0A = (unsigned char *)0x00C0;
volatile unsigned char *myUCSR0B = (unsigned char *)0x00C1;
volatile unsigned char *myUCSR0C = (unsigned char *)0x00C2;
volatile unsigned int  *myUBRR0  = (unsigned int *) 0x00C4;
volatile unsigned char *myUDR0   = (unsigned char *)0x00C6;

volatile unsigned char* my_ADMUX = (unsigned char*) 0x7C;
volatile unsigned char* my_ADCSRB = (unsigned char*) 0x7B;
volatile unsigned char* my_ADCSRA = (unsigned char*) 0x7A;
volatile unsigned int* my_ADC_DATA = (unsigned int*) 0x78;

void setup() {

  //Serial.begin(9600);
  U0init(9600);
  adc_init();

  pinMode(buttonPin, INPUT);
  pinMode(fanPin, OUTPUT);
  pinMode(motorPin, INPUT);
  pinMode(rPin, OUTPUT);
  pinMode(gPin, OUTPUT);
  pinMode(bPin, OUTPUT);
  myStepper.setSpeed(200);



  lcd.begin(16, 2);
  lcd.setCursor(7,1);
  lcd.print("---");
  dht.begin();
  DDRB |= (1 << 5);
  

  lcd.setCursor(0,0);
  lcd.print("Temp:");
  lcd.setCursor(0,1);
  lcd.print("Humid:");
  delay(1500);
  }

void loop() {

  if(digitalRead(buttonPin)==HIGH){
      buttonPressed = true;
      delay(2000);
  }
  while(buttonPressed){
    digitalWrite(gPin, HIGH);
    digitalWrite(bPin, HIGH);
    digitalWrite(rPin, LOW);
    digitalWrite(fanPin, LOW);
    motor_move();
    if(digitalRead(buttonPin)==HIGH){
      buttonPressed = false; 
  }
  }

//set green light
    digitalWrite(gPin, HIGH);
    digitalWrite(bPin, LOW);
    digitalWrite(rPin, LOW);
    
  unsigned int adc_value = adc_read(0);
 if (digitalRead(motorPin) == HIGH)
 {
   motor_move();
 }


// if (buttonState != HIGH){

  lcd.setCursor(12,1);
  lcd.print("%");

  delay(550);
  lcd.setCursor(13,0);
  lcd.print("<");
  delay(50);
  lcd.setCursor(14,0);
  lcd.print("-");
  delay(50);
  lcd.setCursor(15,0);
  lcd.print("-");
  delay(50);
  lcd.setCursor(15,1);
  lcd.print("-");
  delay(50);
  lcd.setCursor(14,1);
  lcd.print("-");
  delay(50);
  lcd.setCursor(13,1);
  lcd.print("<");

  lcd.setCursor(12,0);
  lcd.print(" ");
  float f = DHT.Humidity;
  float c = DHT.Temperature;
